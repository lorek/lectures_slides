\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{enumitem}
\usepackage[T1]{fontenc}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{pstricks}
 \usepackage{amsthm}
 
%\usepackage[nohead]{geometry}
%\usepackage{amsmath,amsthm,amssymb,euler}

% \newtheorem{deff}{Definicja}[subsection]
% \newtheorem{twr}[deff]{Twierdzenie}
% \newtheorem{lem}{Lemat}
% \newtheorem{uwaga}[deff]{Uwaga}
% \newtheorem{alg}[deff]{Algorytm}
 \usepackage{algorithm}
\usepackage{algorithmic}
%Change: REQUIRE -> Input and ENSURE -> Output
%\renewcommand{\algorithmicrequire}{\textbf{Input:}}
%\renewcommand{\algorithmicensure}{\textbf{Output:}}


\newtheorem{deff}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{uwaga}[deff]{Remark}
\newtheorem{alg}[deff]{Algorithm}

%\newcommand{\e}[0]{\mathbf{e}}
%\newcommand{\s}[0]{\mathbf{s}}
%\newcommand{\PP}[0]{\mathbf{P}}
%\newcommand{\E}[0]{\mathbb{E}}
 
\renewcommand\theequation{\thesection.\arabic{equation}}
%\setlength{\textwidth}{16cm}
%\setlength{\oddsidemargin}{3cm}
%\setlength{\evensidemargin}{3cm}
%\setlength{\hoffset}{-1in} %


\addtolength{\voffset}{-2.2cm}
\addtolength{\hoffset}{-1.0cm}
\addtolength{\textwidth}{2.0cm}
\addtolength{\textheight}{3.2cm}



\setlength{\fboxrule}{11cm}

\usepackage{fancyhdr}
\pagestyle{fancy}
\renewcommand\headrulewidth{0pt}
\fancyhead[LE,LO,RE,RO]{}
\fancyfoot[LE,LO]{\tiny {\tt\jobname    }}
\fancyfoot[RE,RO]{\tiny {\tt \leftmark     }}
%\rightmark - \leftmark --
\fancyfoot[c]{\thepage   }

\newcount\cnt
\def\nn {{
{\message{-\the\cnt-}}\par
\bf \the\cnt .\   \global\advance\cnt by 1}}
\def\nx {{
{\message{-\the\nu-}}\hskip 10truept
\bf \the\cnt .\   \global\advance\cnt by 1}}
\def\ny {{
{\message{-\the\cnt-}}\par\noindent
\bf \the\cnt .\   \global\advance\cnt by 1}}
\def\nz {{\hskip -2truept
{\message{-\the\cnt-}}
\bf \the\cnt .\   \global\advance\cnt by 1}}

\def\bp {\bigskip\par}

\usepackage{setspace}

\parindent 0pt

\everymath{\displaystyle}

\input{setup/packages2_noalg}
\input{setup/macros2}
 
\begin{document}
 
\noindent
 {
\setlength\fboxsep{4pt}%
 \setlength\fboxrule{2pt}%
 \fbox{%
  \begin{tabular}{lcr}
\multicolumn{2}{l}{\bf  Simulations and algorithmic applications of Markov chains} &     2024/25  \\ \\
\multicolumn{3}{c}{   List nr 11} \\
\multicolumn{2}{l}{ PaweÅ‚ Lorek} &  \\  
 \end{tabular}%
}}
\bigskip\bigskip
 
% \textbf{Ising model}. Let $G=(V,K)$ be a graph. Ising model provides a way 
% of choosing a random element $\e$ from $\{-1,+1\}^V$, called a \textsl{configuration}.
% For a given configuration $\e$ by $e(v)\in\{-1,+1\}$ we denote its (spin) value at vertex $v$.
% Fix some $\beta\neq 0$. For a given configuration we define its energy by
% $$H(\e)=-\sum_{(w,w')\in K} e(w)e(w').$$
% The Ising model is a distribution 
% $$\pi(\e)={1\over C} \exp\left(-\beta H(\e)\right)
% ={1\over C} \exp\left(\beta \sum_{(w,w')\in K} e(w)e(w')\right).$$
% 

\bigskip\par
In definitions below, $S$ is a finite set.

\begin{deff}
 A probability measure $\pi$ on $\E=S^V$ is \textbf{monotone} if 
 for all $\e\preceq\e'$ and all $v\in V$ such that $\pi(\e_{-v})>0$ and $\pi(\e'_{-v})>0$
 we have, denoting $Z\sim\pi$,
 $$\Prob(Z(v)\leq s| Z_{-v}=\e_{-v}) \geq \Prob(Z(v)\leq s| Z_{-v}=\e'_{-v}) \textrm{ for all } s\in S.$$
\end{deff}
\smallskip\par
\begin{deff}
 A probability measure $\pi$ on $\E=S^V$ is \textbf{anti-monotone} if 
 for all $\e\preceq\e'$ and all $v\in V$ such that $\pi(\e_{-v})>0$ and $\pi(\e'_{-v})>0$
 we have, denoting $Z\sim\pi$,
 $$\Prob(Z(v)\leq s| Z_{-v}=\e_{-v}) \leq \Prob(Z(v)\leq s| Z_{-v}=\e'_{-v}) \textrm{ for all } s\in S.$$
\end{deff}

\medskip\par
  
\begin{enumerate}
 \item Recall Ising model: for a given graph $G=(V,K)$, it is a way 
 of choosing a random element $\e$ from $\E=\{-1,+1\}^V$ (which we call a configuration).
 For a given configuration $\e$, a value $\e(v)\in\{-1,+1\}$ is called a spin of vertex $v$.
 The model is a distribution, the probability of configuration $\e$ is 
 $$\pi(\e)={1\over C} \exp\left(\beta \sum_{v_1, v_2: \atop (v_1,v_2)\in K} \e(v_1)\e(v_2)\right).$$
 Show that $\pi$ is monotone for $\beta>0$ and anti-monotone for $\beta<0$.
 
 \item 
 Recall a generalized hardcore model: for a given graph $G=(V,K)$, it is a way 
 of choosing a random element $\e$ from $\E=\{0,1\}^V$. A \textsl{proper configuration} 
 is a configuration such that if $(v,w)\in K$ then $\e(v)\e(w)=0$ (i.e.,
 two ends of some edge cannot have both value 1). For a given $\lambda>0$, the model 
 is a distribution, the probability of configuration $\e$ is 
 $$\pi(\e)=
 \left\{ 
 \begin{array}{llll}
  {1\over C} \lambda^{m(\e)} & \textrm {if } \e \textrm{ is a proper configuration},\\[10pt]
  0 & \textrm{otherwise},
 \end{array}
 \right. 
 $$
 where $m(\e)=\sum_{v\in V}\e(v)$, i.e., it is a number of ones in the configuration.
 \smallskip\par 
 Show that $\pi$ is anti-monotone.
 
  
  \item Describe
a  CFTP (Coupling From The Past) algorithm for perfect simulation
for a Markov chain with a monotone (wrt linear ordering) update function  $\phi$.
Present how it works for a birth and death chain on $\E=\{1,2,3,4\}$
with transitin matrix  $\PP(i,i-1)=1/4$ for $i\in\{2,3,4\}, \PP(i,i+1)=3/4$
for  $i\in\{1,2,3\}$, $\PP(1,1)=1/4, \PP(4,4)=3/4$,
with a following monotone update function
$$
\phi(i,u)=\left\{\begin{array}{lll}
 \max(i-1,1) & \textrm{if\ }  u\in [0,0.25) \\[7pt]
 \min(i+1,4) & \textrm{if\ }  u\in [0.25,1] \\[7pt]
\end{array}\right.
$$
As consecutive time steps use $(-N_1, -N_2, -N_3, -N_4,\ldots)=(-1,-2,-3,-4,-5,\ldots)$.
Recall recursion: $X_{k+1}=\phi(X_k,U_{k+1})$.
\begin{enumerate}
\item Provide sample  $ U_{-1}, U_{-2}, U_{-3}, U_{-4}$ and
show (graph) how it works.
\item Provide such a sequence  $ U_{-1}, U_{-2}, U_{-3}, U_{-4}$
that the algorithm must start at times $-1, -2, -3, -4$
and then it stops (thus, it does not stop starting only from -1,-2 and -3).
What value will it return then?

\end{enumerate}

     \item Prove the following lemma:

    \textbf{Lemma. }
\sl
    Let $\varepsilon\in[0,1]$, let $k$ be a positive integer, and let $a_1,\ldots,a_k$ and $b_1,\ldots,b_k$ be non-negative numbers that satisfy
 $$\left(1-{\varepsilon\over 2k}\right)\leq{a_j\over b_j}\leq \left(1+{\varepsilon\over 2k}\right),\qquad j=1,\ldots,k.$$
 Then
 $$1-\varepsilon\leq {a\over b}\leq 1+\varepsilon,$$
 where $a=\prod_{j=1}^k a_j, b=\prod_{j=1}^k b_j$.
\rm



\end{enumerate}



\end{document}
